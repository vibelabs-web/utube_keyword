# TRD (기술 요구사항 정의서)

> 유튜브 키워드 분석기 & 댓글 분석기 - 기술 설계 문서

---

## MVP 캡슐

| # | 항목 | 내용 |
|---|------|------|
| 1 | 목표 | 바이브코딩 채널의 성장 속도를 높이기 위해 잘 될 콘텐츠 주제를 데이터 기반으로 찾는다 |
| 2 | 페르소나 | 바이브코딩 유튜버 (구독자 5,000명, 영상 50개, 성장 가속화 희망) |
| 3 | 핵심 기능 | FEAT-1: 키워드 분석, FEAT-2: 댓글 분석 |
| 4 | 성공 지표 (노스스타) | 분석 도구를 통해 선정한 주제의 영상 조회수 10,000회 달성 |
| 5 | 입력 지표 | 주 1회 이상 키워드 분석 실행, 월 4회 이상 댓글 분석 실행 |
| 6 | 비기능 요구 | API 응답 시간 5초 이내, 웹 인터페이스 |
| 7 | Out-of-scope | 다른 사용자 서비스, 모바일 앱, 유료화, 인증 시스템 |
| 8 | Top 리스크 | 시간 부족으로 개발 중단 |
| 9 | 완화/실험 | MVP 기능 최소화, 1~2주 내 완료 목표, AI 코딩 활용 |
| 10 | 다음 단계 | YouTube Data API 키 발급 및 테스트 |

---

## 1. 시스템 아키텍처

### 1.1 고수준 아키텍처

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│     Client      │────▶│     Server      │────▶│  External APIs  │
│   (React SPA)   │     │   (FastAPI)     │     │  (YouTube API)  │
└─────────────────┘     └─────────────────┘     └─────────────────┘
                               │
                               ▼
                        ┌─────────────────┐
                        │    Database     │
                        │   (SQLite)      │
                        └─────────────────┘
```

### 1.2 컴포넌트 설명

| 컴포넌트 | 역할 | 왜 이 선택? |
|----------|------|-------------|
| Frontend (React) | 웹 인터페이스 제공 | 빠른 개발, 풍부한 생태계 |
| Backend (FastAPI) | API 서버, 비즈니스 로직 | Python 기반, 빠른 개발, 자동 문서화 |
| Database (SQLite) | 분석 결과 캐싱 | 단일 사용자, 설정 간편, 파일 기반 |
| YouTube Data API | 키워드/댓글 데이터 수집 | 공식 API, 신뢰할 수 있는 데이터 |

---

## 2. 권장 기술 스택

### 2.1 프론트엔드

| 항목 | 선택 | 이유 | 벤더 락인 리스크 |
|------|------|------|-----------------|
| 프레임워크 | React 19 | 최신 버전, 풍부한 생태계 | 낮음 |
| 언어 | TypeScript | 타입 안정성, 개발 생산성 | - |
| 스타일링 | TailwindCSS | 빠른 스타일링, 유틸리티 기반 | 낮음 |
| 상태관리 | Zustand | 간단한 API, 보일러플레이트 최소 | 낮음 |
| HTTP 클라이언트 | Axios | 널리 사용, 인터셉터 지원 | 낮음 |
| 빌드 도구 | Vite | 빠른 개발 서버, HMR | 낮음 |

### 2.2 백엔드

| 항목 | 선택 | 이유 | 벤더 락인 리스크 |
|------|------|------|-----------------|
| 프레임워크 | FastAPI | 빠른 개발, 자동 OpenAPI 문서 | 낮음 |
| 언어 | Python 3.11+ | AI/데이터 처리에 강점 | - |
| ORM | SQLAlchemy 2.0 | 성숙한 ORM, 비동기 지원 | 낮음 |
| 검증 | Pydantic v2 | FastAPI 통합, 빠른 검증 | 낮음 |
| 텍스트 분석 | KoNLPy / konlpy | 한국어 형태소 분석 | 낮음 |

### 2.3 데이터베이스

| 항목 | 선택 | 이유 |
|------|------|------|
| 메인 DB | SQLite | 단일 사용자, 설정 불필요, 파일 기반 |
| 캐시 | 메모리 (dict) | 단순, 추가 의존성 없음 |

### 2.4 인프라

| 항목 | 선택 | 이유 |
|------|------|------|
| 컨테이너 | Docker + Docker Compose | 로컬 개발 일관성, 환경 재현 |
| 호스팅 | 로컬 실행 (추후 Vercel/Railway) | MVP는 로컬, 필요 시 배포 |

---

## 3. 비기능 요구사항

### 3.1 성능

| 항목 | 요구사항 | 측정 방법 |
|------|----------|----------|
| 키워드 분석 응답 | < 5초 | API 응답 시간 |
| 댓글 수집 (100개) | < 10초 | API 응답 시간 |
| 초기 로딩 | < 3초 (FCP) | Lighthouse |

### 3.2 보안

| 항목 | 요구사항 |
|------|----------|
| API 키 보호 | .env 파일로 관리, 커밋 금지 |
| HTTPS | 배포 시 필수 |
| 입력 검증 | 서버 측 필수 (Pydantic) |

### 3.3 확장성

| 항목 | 현재 | 목표 |
|------|------|------|
| 동시 사용자 | MVP: 1명 (본인) | 확장 계획 없음 |
| 데이터 용량 | MVP: 100MB | 필요 시 PostgreSQL 전환 |

---

## 4. 외부 API 연동

### 4.1 YouTube Data API v3

| 엔드포인트 | 용도 | 필수/선택 |
|-----------|------|----------|
| `search.list` | 키워드 검색, 검색량 추정 | 필수 |
| `videos.list` | 영상 상세 정보 (조회수 등) | 필수 |
| `commentThreads.list` | 댓글 수집 | 필수 |

**API 할당량 관리:**
- 일일 할당량: 10,000 단위
- 검색 요청: 100 단위/요청
- 댓글 요청: 1 단위/요청
- 캐싱으로 중복 요청 방지

### 4.2 기타 서비스 (선택)

| 서비스 | 용도 | 필수/선택 | 비고 |
|--------|------|----------|------|
| Google Trends API | 검색 트렌드 데이터 | 선택 | v2에서 검토 |

---

## 5. 접근제어·권한 모델

### 5.1 역할 정의

| 역할 | 설명 | 권한 |
|------|------|------|
| User (본인) | 유일한 사용자 | 전체 접근 |

**인증 없음:** 로컬에서 본인만 사용하므로 인증 시스템 불필요

---

## 6. 데이터 생명주기

### 6.1 원칙

- **최소 저장**: 분석 결과만 캐싱
- **YouTube 정책 준수**: 댓글 데이터 장기 보관 금지
- **로컬 저장**: 클라우드 전송 없음

### 6.2 데이터 흐름

```
API 요청 → YouTube API 호출 → 분석 처리 → 결과 표시 → (선택) 캐시 저장
```

| 데이터 유형 | 보존 기간 | 삭제/익명화 |
|------------|----------|------------|
| 키워드 분석 결과 | 7일 캐싱 | 자동 만료 |
| 댓글 원본 | 분석 후 즉시 삭제 | 원본 미저장 |
| 분석 통계 | 30일 | 수동 삭제 |

---

## 7. 테스트 전략

### 7.1 테스트 피라미드

| 레벨 | 도구 | 커버리지 목표 | 위치 |
|------|------|-------------|------|
| Unit | pytest / Vitest | ≥ 70% | tests/unit/ |
| Integration | pytest | Critical paths | tests/integration/ |
| E2E | Playwright | Key user flows | e2e/ |

### 7.2 테스트 도구

**백엔드:**
| 도구 | 용도 |
|------|------|
| pytest | 테스트 실행 |
| pytest-asyncio | 비동기 테스트 |
| httpx | API 테스트 클라이언트 |
| pytest-cov | 커버리지 측정 |

**프론트엔드:**
| 도구 | 용도 |
|------|------|
| Vitest | 테스트 실행 |
| React Testing Library | 컴포넌트 테스트 |
| MSW | API 모킹 |

### 7.3 품질 게이트

**병합 전 필수 통과:**
- [ ] 모든 단위 테스트 통과
- [ ] 커버리지 ≥ 70%
- [ ] 린트 통과 (ruff / ESLint)
- [ ] 타입 체크 통과 (mypy / tsc)

---

## 8. API 설계

### 8.1 키워드 분석 API

```
POST /api/v1/keywords/analyze
Request:
{
  "keyword": "바이브코딩",
  "include_related": true
}

Response:
{
  "data": {
    "keyword": "바이브코딩",
    "search_volume": 12000,
    "competition": "medium",
    "competition_score": 0.45,
    "related_keywords": [
      {"keyword": "AI 코딩", "search_volume": 8000},
      {"keyword": "cursor ai", "search_volume": 15000}
    ]
  }
}
```

### 8.2 댓글 분석 API

```
POST /api/v1/comments/analyze
Request:
{
  "video_url": "https://youtube.com/watch?v=xxx",
  "max_comments": 100
}

Response:
{
  "data": {
    "video_id": "xxx",
    "total_comments": 150,
    "analyzed_comments": 100,
    "frequent_words": [
      {"word": "좋아요", "count": 45},
      {"word": "궁금해요", "count": 23}
    ],
    "requests": [
      {"text": "다음에는 Claude 사용법도 알려주세요", "likes": 12},
      {"text": "실전 프로젝트 영상 부탁드려요", "likes": 8}
    ],
    "sentiment": {
      "positive": 0.75,
      "neutral": 0.20,
      "negative": 0.05
    }
  }
}
```

### 8.3 응답 형식

**성공 응답:**
```json
{
  "data": { ... },
  "meta": {
    "timestamp": "2024-01-17T12:00:00Z"
  }
}
```

**에러 응답:**
```json
{
  "error": {
    "code": "YOUTUBE_API_ERROR",
    "message": "YouTube API 할당량 초과",
    "details": []
  }
}
```

---

## 9. 프로젝트 구조

```
zettel/
├── frontend/
│   ├── src/
│   │   ├── components/       # 재사용 컴포넌트
│   │   ├── pages/            # 페이지 컴포넌트
│   │   ├── hooks/            # 커스텀 훅
│   │   ├── services/         # API 호출
│   │   ├── stores/           # Zustand 스토어
│   │   └── types/            # TypeScript 타입
│   └── tests/
├── backend/
│   ├── app/
│   │   ├── api/              # API 라우트
│   │   ├── core/             # 설정, 의존성
│   │   ├── models/           # DB 모델
│   │   ├── schemas/          # Pydantic 스키마
│   │   ├── services/         # 비즈니스 로직
│   │   │   ├── youtube.py    # YouTube API 연동
│   │   │   ├── keyword.py    # 키워드 분석
│   │   │   └── comment.py    # 댓글 분석
│   │   └── utils/            # 유틸리티
│   └── tests/
├── docs/
│   └── planning/             # 기획 문서
├── docker-compose.yml
└── .env.example
```

---

## Decision Log

| 날짜 | 결정 | 이유 |
|------|------|------|
| 2024-01-17 | SQLite 선택 | 단일 사용자, 설정 간편 |
| 2024-01-17 | 인증 미구현 | 로컬 전용, 본인만 사용 |
| 2024-01-17 | FastAPI + React | 빠른 개발, Python 기반 텍스트 분석 용이 |
| 2024-01-17 | 로컬 우선 | MVP는 로컬, 배포는 추후 검토 |
